<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Sway PR Data{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Future: Add favicon, other common head elements -->
</head>
<body>
    <!-- Main Content Wrapper (for top bar and canvas) -->
    <div class="main-content-wrapper">
        <!-- Global Top Bar -->
        <header class="global-top-bar">
            <div class="top-bar-left">
                <button id="mobile-nav-toggle" class="mobile-nav-toggle-btn">
                    <i class="bi bi-list"></i>
                </button>
                <div class="top-bar-page-title">
                    <h3>{% block page_title %}Dashboard{% endblock %}</h3>
                </div>
            </div>
            <div class="top-bar-right">
                <button class="top-bar-action-btn">
                     <i class="bi bi-plus-lg"></i>
                    <span>Add New</span>
                </button>
                <div class="icon-group">
                    <button class="icon-btn"><i class="bi bi-search"></i></button>
                    <button class="icon-btn"><i class="bi bi-bell-fill"></i></button>
                </div>
                 <!-- Profile Dropdown would go here, but for now, we link to the sidebar's logout -->
            </div>
        </header>

        <!-- Fixed Left Sidebar -->
        <aside class="left-sidebar">
            <div class="sidebar-header">
                <i class="bi bi-bar-chart-line-fill sidebar-emblem"></i>
                <h1 class="sidebar-product-name">Sway PR</h1>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-group">
                    <li class="nav-section-header">Main</li>
                    <li class="{{ 'active' if request.endpoint == 'index' else '' }}">
                        <a href="{{ url_for('index') }}">
                            <i class="bi bi-grid-1x2-fill nav-icon"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="{{ 'active' if request.endpoint == 'published_reports' else '' }}">
                        <a href="{{ url_for('published_reports') }}">
                           <i class="bi bi-file-earmark-bar-graph-fill nav-icon"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                </ul>
                <hr class="nav-divider">
                <ul class="nav-group">
                    <li class="nav-section-header">Tools</li>
                    <li class="{{ 'active' if request.endpoint == 'staff_management' else '' }}">
                        <a href="{{ url_for('staff_management') }}">
                            <i class="bi bi-people-fill nav-icon"></i>
                           <span>Staff</span>
                        </a>
                    </li>
                    <li class="{{ 'active' if request.endpoint == 'email_templates' else '' }}">
                        <a href="{{ url_for('email_templates') }}">
                            <i class="bi bi-envelope-paper-fill nav-icon"></i>
                            <span>Email Templates</span>
                        </a>
                    </li>
                    <li class="{{ 'active' if request.endpoint == 'follow_up_email' else '' }}">
                        <a href="{{ url_for('follow_up_email') }}">
                            <i class="bi bi-arrow-right-circle-fill nav-icon"></i>
                            <span>Follow-ups</span>
                        </a>
                    </li>
                </ul>
                 <hr class="nav-divider">
                 <ul class="nav-group">
                    <li class="{{ 'active' if request.endpoint == 'settings_placeholder' else '' }}">
                        <a href="#">
                            <i class="bi bi-gear-fill nav-icon"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-user-footer">
                <div class="user-avatar-placeholder">
                    <span>{{ current_user.username[0]|upper if current_user.is_authenticated else 'G' }}</span>
                </div>
                <div class="user-info">
                    <span class="user-name">{{ current_user.username if current_user.is_authenticated else 'Guest User' }}</span>
                </div>
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('logout') }}" class="logout-link-sidebar" title="Logout">
                        <i class="bi bi-box-arrow-right"></i>
                    </a>
                {% else %}
                     <a href="{{ url_for('login') }}" class="login-link-sidebar" title="Login">
                        <i class="bi bi-box-arrow-in-right"></i>
                    </a>
                {% endif %}
            </div>
        </aside>

        <!-- Main Canvas -->
        <main class="main-canvas">
            <div id="dynamic-flash-container"></div>
            {% block page_header %}{% endblock %} {# For greeting banner, section heading #}

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        {% for category, message in messages %}
                            showFlashMessage("{{ message|safe }}", "{{ category }}");
                        {% endfor %}
                    });
                </script>
                {% endif %}
            {% endwith %}

            {% block content %}
            <!-- Page specific content will go here -->
            {% endblock %}
        </main>
    </div> <!-- Closing main-content-wrapper -->

    <!-- Footer is removed as per new design (user footer in sidebar) -->
    <!-- Or can be a minimal one if needed -->

    <script>
        // current-year script removed as footer is removed/re-imagined
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/flash.js') }}"></script>
    {% block extra_js %}{% endblock %}
    {% block inline_js %}{% endblock %}
</body>
</html>
